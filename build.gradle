allprojects {
    apply plugin: 'eclipse'
    apply plugin: 'idea'

    apply plugin: 'findbugs'
    tasks.withType(FindBugs) {
        excludeFilter = file("findbugs-exclude.xml")
        reports {
            xml.enabled false
            html.enabled true
        }
    }
    apply plugin: 'checkstyle'
    tasks.withType(Checkstyle) {
        reports {
            xml.enabled false
            html.enabled true
		}
		// Spring uses public methods in CRUD Repositories -> disabled
		exclude '**/de/fau/amos/virtualledger/server/persistence/**Repository**'
    }
    checkstyle{
	toolVersion = '6.7'
    }

    repositories {
        mavenCentral()
	jcenter()
    }
}

project(':server'){
	apply plugin: 'java'
	apply from: 'https://raw.github.com/akhikhl/gretty/master/pluginScripts/gretty.plugin'
	apply plugin: 'jacoco'

	check.dependsOn {
		project(':server').jacocoTestReport
	}
	jacocoTestReport {
		afterEvaluate {
			classDirectories = files(classDirectories.files.collect {
			fileTree(dir: it, exclude: 'META-INF/**')
			}
		)}
		reports {
       			 xml.enabled true
       			 csv.enabled false
       			 html.destination "${buildDir}/jacocoHtml"
   		 }
	}
}

project(':dtos'){
	apply plugin: 'java'
	apply plugin: 'jacoco'

	check.dependsOn {
		project(':dtos').jacocoTestReport
	}
	jacocoTestReport {
		afterEvaluate {
			classDirectories = files(classDirectories.files.collect {
			fileTree(dir: it, exclude: 'META-INF/**')
			}
		)}
		reports {
       			 xml.enabled true
       			 csv.enabled false
       			 html.destination "${buildDir}/jacocoHtml"
   		 }
	}
}

